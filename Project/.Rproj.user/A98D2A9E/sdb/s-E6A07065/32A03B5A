{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Global child malnutrition overview\"\noutput:\n  html_document: default\n---\n\n```{r setup, include=FALSE}\nsetwd(\"C:/Users/crish/OneDrive/Documents/Columbia SIPA/2017 Spring/Data Visualization/Final Project/\")\n\nlibrary(readr)\njme_latest <- readstata13::read.dta13(\"data/JME_2016_latest.dta\")\njme <- readstata13::read.dta13(\"data/JME_2016.dta\")\ndisparities <- readstata13::read.dta13(\"data/stunting disparities.dta\")\n```\n\n## Nearly half of all deaths in children under 5 are attributable to undernutrition\n\nUndernutrition puts children at greater risk of dying from common infections, increases the frequency and severity of such infections, and contributes to delayed recovery. \n\nPoor nutrition in the first 1,000 days of a child's life can also lead to stunted growth, which is irreversible and associated with impaired cognitive ability and reduced school and work performance.\n\n###Forms of malnutrition\n\n<img src=\"C:/Users/crish/OneDrive/Documents/GitHub/Final-Project/images/definitions.png\" width=\"100%\" />\n\n\n\n```{r, include=FALSE}\nlibrary(raster)\nworld_spdf <- shapefile(\"C:/Users/crish/OneDrive/Documents/Columbia SIPA/2017 Spring/Data Visualization/Final Project/data/world_map/TM_WORLD_BORDERS_SIMPL-0.3.shp\")\n\n# Merge the QoG data to Shape Files\nlibrary(dplyr)\nmapjme <- world_spdf@data %>% left_join(jme_latest, by = c(ISO3 = \"iso\"))\nworld_spdf@data <- mapjme\n\n```\n\n####Map 1. Prevalence of wasting and stunting per country\n\n```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align='center'}\n\nlibrary(leaflet)\nleaflet(world_spdf) %>% \n  addProviderTiles(\"Esri.WorldGrayCanvas\")  %>% \n  setView(lat=25, lng=2.8 , zoom=2) %>%\n  \n    # Base groups = Background layer\n    addTiles(group = \"OpenStreetMap\") %>%\n    addProviderTiles(providers$Stamen.TonerLite, group = \"Toner Lite\") %>%\n    addProviderTiles(providers$Stamen.Toner, group = \"Toner\")  %>%\n    \n    # Data Layers\n      # First Data Layer\n    addPolygons(group=\"Wasting\", data=world_spdf,\n                stroke = FALSE, fillOpacity = 1, smoothFactor = 0.5, \n                color = ~colorNumeric(\"Oranges\", wasting)(wasting),\n                popup = paste(\"Country:\",world_spdf$NAME,\"<br/>\",\n                              \"Wasting prevalence:\", world_spdf$wasting,\"%\",\"<br/>\")) %>%\n    addLegend(\"bottomright\", pal = colorNumeric(\"Oranges\", world_spdf$wasting), \n              values = ~wasting, title = \"% Wasting\", opacity = 1) %>%\n  \n  # Second Data Layer:\n  addPolygons(group=\"Stunting\",\n                stroke = FALSE, fillOpacity = 1, smoothFactor = 0.5, \n                color = ~colorQuantile(\"Reds\", stunting)(stunting),\n                popup = paste(\"Country:\",world_spdf$NAME,\"<br/>\",\n                              \"Stunting prevalence:\", world_spdf$stunting,\"%\",\"<br/>\")) %>%\n  addLegend(\"bottomright\", pal = colorNumeric(\"Reds\", world_spdf$stunting), \n            values = ~stunting, title = \"% Stunting\", opacity = 1) %>%\n  \n    # Layers control\n    addLayersControl(\n    baseGroups = c(\"OpenStreetMap\", \"Toner\", \"Toner Lite\"),\n    overlayGroups = c(\"Stunting\",\"Wasting\"),\n    options = layersControlOptions(collapsed = TRUE) )\n```\n\n\n##The relationship between wasting and stunting \n\n####Countries with higher levels of stunting demand immediate attention...\n\n```{r, include=FALSE}\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(scales)\n\nggplot(jme_latest, aes(x=stunting, y=wasting, color=region)) + geom_point(alpha=0.5, size=3) + \n  ggtitle(\"Prevalence of stunting and wasting\") + \n  labs(x=\"Stunting (%)\", y = \"Wasting (%)\", size=8) +\n  theme_classic(base_size = 12) + theme(text = element_text(color = \"gray20\"),\n                                        axis.text.x = element_text(NULL),\n          legend.position = c(\"bottom\"),\n          axis.text = element_text(face = \"italic\"),\n          axis.title.x = element_text(vjust = -1),\n          axis.title.y = element_text(vjust = 2),\n          axis.ticks.y = element_blank(),\n          axis.line = element_line(color = \"gray40\", size = 0.5),\n          axis.line.y = element_blank(),\n          panel.grid.major = element_line(color = \"gray50\", size = 0.5),\n          panel.grid.major.x = element_blank(),\n          plot.margin = margin(t = 0, r = 0, b = 40, l = 5, unit = \"pt\"),\n          plot.title = element_text(face = \"bold\", color = \"black\", size = 11, hjust=0.5))\n```\n\n#### Graph 1. Relationship between stunting and wasting prevalence\n\n```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align='center'}\nlibrary(plotly) \nplot_ly(jme_latest, x = ~stunting, y=~wasting, \n                     color = ~region, type = \"scatter\",\n                     text = ~paste(country, 'Year:', year))\n```\n\n\n\nAt a regional level, South Asia is the most affected region with over 20 million children with malnutrition. \n\n```{r, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(scales)\n\njme2014 <- jme[which(jme$year=='2014'),]\n\nggplot(subset(jme2014), aes(x=region, y=num_wasting, fill=region)) + geom_bar(stat = \"identity\") + \n         scale_fill_brewer(palette=\"YlGnBu\") + coord_flip() +\n  ggtitle(\"Graph 2. Number of children wasted, 2014\") + \n  labs(x=\"\", y = \"Children wasted\", size=8) +\n  theme_classic(base_size = 12) + theme(text = element_text(color = \"gray20\"),\n                                        axis.text.x = element_text(NULL),\n          legend.position = c(\"none\"),\n          axis.text = element_text(face = \"italic\"),\n          axis.title.x = element_text(vjust = -1),\n          axis.title.y = element_text(vjust = 2),\n          axis.ticks.y = element_blank(),\n          axis.line = element_line(color = \"gray40\", size = 0.5),\n          axis.line.y = element_blank(),\n          panel.grid.major = element_line(color = \"gray50\", size = 0.5),\n          panel.grid.major.x = element_blank(),\n          plot.margin = margin(t = 0, r = 0, b = 40, l = 5, unit = \"pt\"),\n          plot.title = element_text(face = \"bold\", color = \"black\", size = 11, hjust=0.5))\n```\n\n\n###Trends in malnutrition prevalence\n\n```{r, include=FALSE}\n\njmeyears <- jme[which(jme$year=='2000' | jme$year=='2006' | jme$year=='2010' | jme$year=='2014'),]\n\nggplot(data=jmeyears, aes(x=year, y=num_wasting, fill=year)) + geom_bar(stat = \"identity\") + \n         scale_fill_brewer(palette=\"YlGnBu\") + \n  ggtitle(\"Graph 1. Number of children wasted, 2014\") + \n  labs(x=\"\", y = \"Number of children wasted\", size=8) +\n  theme_classic(base_size = 12) + theme(text = element_text(color = \"gray20\"),\n                                        axis.text.x = element_text(NULL),\n          legend.position = c(\"none\"), \n          axis.text = element_text(face = \"italic\"),\n          axis.title.x = element_text(vjust = -1),\n          axis.title.y = element_text(vjust = 2),\n          axis.ticks.y = element_blank(),\n          axis.line = element_line(color = \"gray40\", size = 0.5),\n          axis.line.y = element_blank(),\n          panel.grid.major = element_line(color = \"gray50\", size = 0.5),\n          panel.grid.major.x = element_blank(),\n          plot.margin = margin(t = 0, r = 0, b = 40, l = 5, unit = \"pt\"),\n          plot.title = element_text(face = \"bold\", color = \"black\", size = 11, hjust=0.5))\n```\n\n\n```{r, include=FALSE}\nstunting_global <- c(39.6 , 35.7 , 32.7 , 29.4 , 24.4 , 23.2)\nyear <- c(\"1990\", \"1995\", \"2000\", \"2005\", \"2010\", \"2015\") \ntrend_stunting_global <- data.frame(stunting_global,year)\nnames(trend_stunting_global) <- c(\"stunting_global\",\"year\")\n\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(scales)\nggplot(data=trend_stunting_global, aes(x=year, y=stunting_global)) + \n  geom_bar(stat = \"identity\", fill=\"#009FDF\") + \n  scale_fill_brewer(palette=\"YlGnBu\") +\n  ggtitle(\"Graph 1. Trends in stunting prevalence, 1990-2015\") + \n  labs(x=\"\", y = \"Children given MNP\", size=8) +\n  theme_classic(base_size = 12) + theme(text = element_text(color = \"gray20\"),\n                                        axis.text.x = element_text(NULL),\n          legend.position = c(\"bottom\"), legend.direction = \"horizontal\",\n          legend.justification = 0.05, legend.text = element_text(size = 9, color = \"gray10\"),\n          legend.key.height=unit(1,\"line\"), legend.key.width=unit(1,\"line\"),\n          axis.text = element_text(face = \"italic\"),\n          axis.title.x = element_text(vjust = -1),\n          axis.title.y = element_text(vjust = 2),\n          axis.ticks.y = element_blank(),\n          axis.line = element_line(color = \"gray40\", size = 0.5),\n          axis.line.y = element_blank(),\n          panel.grid.major = element_line(color = \"gray50\", size = 0.5),\n          panel.grid.major.x = element_blank(),\n          plot.margin = margin(t = 0, r = 0, b = 40, l = 5, unit = \"pt\"),\n          plot.title = element_text(face = \"bold\", color = \"black\", size = 11, hjust=0.5))\n```\n\n\n#### Global prevalence of stunting, 1995-2015\n\nMalnutrition rates remain alarming: stunting is declining too slowly\n\n```{r, echo=FALSE}\nplot_ly(trend_stunting_global, x = ~year, y=~stunting_global, \n                     type = \"bar\",\n                     text = ~paste('Stunting (%):',stunting_global, 'Year:', year))\n```\n\n\n\n####Regional trends\n\n```{r, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(scales)\n\njme0614 <- jme[which(jme$year=='2006' | jme$year=='2014'),]\n\nggplot(jme0614, aes(x=year, y=stunting)) + \n  geom_boxplot() +\n  geom_jitter(size = 4, alpha = 0.5, aes(col = region, size=year), na.rm = TRUE)  + facet_grid(. ~ region) +\n  ggtitle(\"Graph 1. Percentage of stunting per region, 2006-2014\") + \n  labs(x=\"\", y = \"Stunting (%)\", size=8) +\n  ggthemes::theme_few(base_size = 12) + theme(text = element_text(color = \"gray20\"),\n                                        axis.text.x = element_text(NULL),\n          legend.position = c(\"none\"), \n          axis.text = element_text(face = \"italic\"),\n          axis.title.x = element_text(vjust = -1),\n          axis.title.y = element_text(vjust = 2),\n          axis.ticks.y = element_blank(),\n          axis.line = element_line(color = \"gray40\", size = 0.5),\n          axis.line.y = element_blank(),\n          panel.grid.major = element_line(color = \"gray50\", size = 0.5),\n          panel.grid.major.x = element_blank(),\n          plot.margin = margin(t = 0, r = 0, b = 40, l = 5, unit = \"pt\"),\n          plot.title = element_text(face = \"bold\", color = \"black\", size = 11, hjust=0.5))\n```\n\n\n\n\n\n```{r, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(scales)\n\nggplot(jme0614, aes(x=year, y=wasting)) + \n  geom_boxplot() +\n  geom_jitter(size = 4, alpha = 0.5, aes(col = region, size=year), na.rm = TRUE)  + facet_grid(. ~ region) +\n  ggtitle(\"Graph 1. Percentage of wasting per region, 2006-2014\") + \n  labs(x=\"\", y = \"Wasting (%)\", size=8) +\n  ggthemes::theme_few(base_size = 12) + theme(text = element_text(color = \"gray20\"),\n                                        axis.text.x = element_text(NULL),\n          legend.position = c(\"none\"), \n          axis.text = element_text(face = \"italic\"),\n          axis.title.x = element_text(vjust = -1),\n          axis.title.y = element_text(vjust = 2),\n          axis.ticks.y = element_blank(),\n          axis.line = element_line(color = \"gray40\", size = 0.5),\n          axis.line.y = element_blank(),\n          panel.grid.major = element_line(color = \"gray50\", size = 0.5),\n          panel.grid.major.x = element_blank(),\n          plot.margin = margin(t = 0, r = 0, b = 40, l = 5, unit = \"pt\"),\n          plot.title = element_text(face = \"bold\", color = \"black\", size = 11, hjust=0.5))\n```\n\n#### Table 1. Wasting and stunting prevalences, 2000-2014\n\n```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=3, fig.align='center'}\n\nmyvars <- c(\"country\", \"region\", \"year\", \"wasting\", \"stunting\", \"pop5\")\njme_short <- jmeyears[myvars]\n\n#install.packages(\"DT\")\nlibrary(DT)\ndatatable(jme_short, \n          colnames = c('Country', 'Region', 'Year', 'Wasting (%)', \n                       'Stunting (%)', 'Children < 5 years old (000)'), \n          filter = 'top', options = list(pageLength = 10, autoWidth = TRUE))\n```\n",
    "created" : 1493738135128.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4088302200",
    "id" : "32A03B5A",
    "lastKnownWriteTime" : 1493757056,
    "last_content_update" : 1493757056803,
    "path" : "C:/Users/crish/OneDrive/Documents/GitHub/Malnutrition/Project/Overview.Rmd",
    "project_path" : "Overview.Rmd",
    "properties" : {
        "last_setup_crc32" : "ABB88DD8ec8df3b7"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}